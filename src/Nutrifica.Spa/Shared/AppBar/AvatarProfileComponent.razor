@using Microsoft.AspNetCore.Components.Authorization
@using Nutrifica.Spa.Infrastructure.Routes
@using Nutrifica.Spa.Infrastructure.Services.Authentication
@inject NutrificaAuthenticationStateProvider AuthStateProvider 

@inject NavigationManager NavigationManager

<AuthorizeView>
    <Authorized>
        <MudMenu
            FullWidth="false"
            AnchorOrigin="Origin.BottomLeft"
            TransformOrigin="Origin.TopCenter"
            Dense="true">
            <ActivatorContent>
                <MudChip
                    Icon="@Icons.Material.Filled.Person"
                    Color="Color.Primary"
                    T="string">
                    Привет, @AuthStateProvider.CurrentUser.FirstName
                </MudChip>
            </ActivatorContent>

            <ChildContent>
                <MudMenuItem
                    OnClick="OnChangePasswordClicked">
                    Сменить пароль
                </MudMenuItem>

                <MudMenuItem
                    Icon="@Icons.Material.Filled.Logout"
                    IconSize="Size.Small"
                    OnClick="OnLogoutClicked">
                    Выйти
                </MudMenuItem>
            </ChildContent>
        </MudMenu>
    </Authorized>
</AuthorizeView>

@code {

    public void OnLogoutClicked()
    {
        NavigationManager.NavigateTo(PageUrls.Logout);
    }

    private void OnChangePasswordClicked(MouseEventArgs obj)
    {
        NavigationManager.NavigateTo(PageUrls.ChangePassword);
    }

}